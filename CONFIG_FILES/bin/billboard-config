#!/usr/bin/perl
use strict;
use warnings;

my $keyPrefix="/apps/billboard";

sub main(@){
  my $config = {
    text => getText(),
    font => '',
    alignment => 'left',
  };

  for my $key(sort keys %$config){
    system "gconftool", "-s", "$keyPrefix/$key", "-t", "str", $$config{$key};
  }
}

sub getText(){
  my $G="{{green}}";
  my $R="{{red}}";
  my $W="{{white}}";

  my $sep = $G . " â˜… ";
  my $batPer = $W . "{battery}%";
  my $batCur = $W . "{script:pad 3 chomp batcur}mA";
  my $time = $W . "{script:chomp date +%H:%M}";
  my $date = $W . "{script:chomp date +%A}, {month} {day}";

  return ''
    . $date . "\n"
    . $time . "\n"
    . $batPer . $sep . $batCur . "\n"
    ;
}

&main(@ARGV);
